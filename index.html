<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>ThreatScope | Cyber Threat Intelligence</title>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">

<style>
*{box-sizing:border-box;font-family:Inter,sans-serif}
body{
  margin:0;
  background:radial-gradient(circle at top,#020617,#000);
  color:#e5e7eb;
}
header{
  display:flex;
  justify-content:space-between;
  align-items:center;
  padding:18px 40px;
  background:#020617;
  border-bottom:1px solid #1e293b;
}
.logo{
  font-size:22px;
  font-weight:700;
  color:#38bdf8;
}
.tag{font-size:12px;color:#94a3b8}
.container{
  max-width:1200px;
  margin:auto;
  padding:40px;
}
.hero{
  text-align:center;
  margin-bottom:40px;
}
.hero h1{
  font-size:42px;
  margin-bottom:10px;
}
.hero p{
  color:#94a3b8;
}
.search-box{
  max-width:600px;
  margin:30px auto;
  display:flex;
  gap:10px;
}
input{
  flex:1;
  padding:14px;
  border-radius:12px;
  border:none;
  background:#020617;
  color:white;
  font-size:16px;
  outline:none;
  border:1px solid #1e293b;
}
button{
  padding:14px 30px;
  background:linear-gradient(90deg,#38bdf8,#0ea5e9);
  border:none;
  border-radius:12px;
  font-weight:700;
  cursor:pointer;
}
.card{
  background:#020617;
  border:1px solid #1e293b;
  border-radius:16px;
  padding:25px;
  margin-top:20px;
}
.grid{
  display:grid;
  grid-template-columns:repeat(auto-fit,minmax(220px,1fr));
  gap:15px;
}
.stat{
  background:#0b1220;
  padding:20px;
  border-radius:12px;
  border:1px solid #1e293b;
  text-align:center;
}
.big{
  font-size:28px;
  font-weight:700;
}
.low{color:#22c55e}
.medium{color:#facc15}
.high{color:#ef4444}
.footer{
  text-align:center;
  padding:20px;
  color:#64748b;
  border-top:1px solid #1e293b;
}
</style>
</head>

<body>

<header>
  <div>
    <div class="logo">ThreatScope</div>
    <div class="tag">Enterprise Cyber Threat Intelligence</div>
  </div>
  <div class="tag">Powered by HanfiNaba SOC Engine</div>
</header>

<div class="container">

<div class="hero">
<h1>Global Threat Intelligence Platform</h1>
<p>Analyze IP addresses against VirusTotal, AbuseIPDB, AlienVault & Shodan in real time.</p>

<div class="search-box">
<input id="ip" placeholder="Enter IP Address (8.8.8.8)">
<button onclick="scan()">Scan</button>
</div>
</div>

<div id="output"></div>

</div>

<div class="footer">
ThreatScope © 2026 | Built for Blue Teams & SOC Analysts
</div>

<script>
async function scan(){
  const ip=document.getElementById("ip").value;
  if(!ip)return alert("Enter IP");
  const out=document.getElementById("output");
  out.innerHTML="<div class='card'>Scanning threat feeds...</div>";
  try{
    const r=await fetch(`https://threat-feed-aggregator.hanfinaba.workers.dev/?ip=${ip}`);
    const d=await r.json();
    const riskClass=d.risk.toLowerCase();

    out.innerHTML=`
    <div class="card">
      <h2>${d.ip}</h2>
      <p class="big ${riskClass}">${d.risk} Risk</p>
      <p>Threat Score: ${d.threat_score}/100</p>
      <p>Confidence: ${d.confidence}</p>
    </div>

    <div class="card">
      <h3>Threat Feeds</h3>
      <div class="grid">
        <div class="stat"><div>VirusTotal</div><div class="big">${d.feeds.virustotal?.malicious||0}</div></div>
        <div class="stat"><div>AbuseIPDB</div><div class="big">${d.feeds.abuseipdb?.abuseConfidenceScore||0}%</div></div>
        <div class="stat"><div>AlienVault</div><div class="big">${d.feeds.alienvault_otx.pulses}</div></div>
        <div class="stat"><div>Shodan Ports</div><div class="big">${d.feeds.shodan?.open_ports?.length||0}</div></div>
      </div>
    </div>

    <div class="card">
      <h3>Why this IP is risky</h3>
      ${d.explanation.map(x=>"<p>• "+x+"</p>").join("")}
    </div>
    `;
  }catch{
    out.innerHTML="<div class='card'>Backend unreachable</div>";
  }
}
</script>

</body>
</html>
