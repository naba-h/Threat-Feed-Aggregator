<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>ThreatScope — Cyber Threat Intelligence</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>

<style>
body {
  margin:0;
  font-family: 'Segoe UI', system-ui;
  background: radial-gradient(circle at top, #0b1f2a, #02060b);
  color:#d9f7ff;
  display:flex;
  justify-content:center;
  align-items:center;
  height:100vh;
}

.app {
  background:#071a26;
  width:820px;
  max-width:95%;
  padding:30px;
  border-radius:16px;
  box-shadow:0 0 60px rgba(0,255,255,.1);
}

h1 {
  text-align:center;
  color:#45f3ff;
  letter-spacing:1px;
  margin-bottom:20px;
}

.search {
  display:flex;
  gap:12px;
}

.search input {
  flex:1;
  padding:14px;
  border-radius:10px;
  border:none;
  outline:none;
  background:#04111a;
  color:#45f3ff;
  font-size:16px;
}

.search button {
  padding:14px 24px;
  border:none;
  border-radius:10px;
  background:#00e0ff;
  color:#001018;
  font-weight:700;
  cursor:pointer;
}

.search button:hover { background:#00c6e0; }

.grid {
  margin-top:25px;
  display:grid;
  grid-template-columns:repeat(3,1fr);
  gap:14px;
}

.card {
  background:#041520;
  padding:18px;
  border-radius:12px;
  border:1px solid #0c2d3f;
}

.label {
  font-size:12px;
  opacity:.6;
}

.value {
  font-size:22px;
  margin-top:6px;
  color:#45f3ff;
}

.footer {
  margin-top:20px;
  text-align:center;
  font-size:12px;
  opacity:.5;
}

.loader {
  margin-top:15px;
  text-align:center;
  color:#45f3ff;
}

.error {
  margin-top:15px;
  color:#ff4d4d;
  text-align:center;
}
</style>
</head>

<body>

<div class="app">
  <h1>ThreatScope</h1>

  <div class="search">
    <input id="ip" placeholder="Enter IP Address (e.g. 8.8.8.8)">
    <button onclick="scan()">Scan</button>
  </div>

  <div class="loader" id="loader" style="display:none">Scanning intelligence feeds…</div>
  <div class="error" id="error"></div>

  <div class="grid">
    <div class="card"><div class="label">Threat Level</div><div class="value" id="verdict">—</div></div>
    <div class="card"><div class="label">Threat Score</div><div class="value" id="score">—</div></div>
    <div class="card"><div class="label">Confidence</div><div class="value" id="confidence">—</div></div>
    <div class="card"><div class="label">Country</div><div class="value" id="country">—</div></div>
    <div class="card"><div class="label">ISP</div><div class="value" id="isp">—</div></div>
    <div class="card"><div class="label">Open Ports</div><div class="value" id="ports">—</div></div>
  </div>

  <div class="footer">
    Powered by Cloudflare Workers • VirusTotal • AbuseIPDB • OTX • Shodan
  </div>
</div>

<script>
const API = "https://threat-feed-aggregator.hanfinaba.workers.dev";

async function scan() {
  const ip = document.getElementById("ip").value.trim();
  const loader = document.getElementById("loader");
  const error = document.getElementById("error");

  error.textContent="";
  if(!ip) return alert("Enter IP");

  loader.style.display="block";

  try {
    const res = await fetch(`${API}/?ip=${ip}`);
    const data = await res.json();

    if(data.error) throw data;

    document.getElementById("verdict").textContent = data.verdict;
    document.getElementById("score").textContent = data.threat_score;
    document.getElementById("confidence").textContent = data.confidence + "%";

    document.getElementById("country").textContent =
      data.sources.abuse?.country || data.sources.vt?.country || "—";

    document.getElementById("isp").textContent =
      data.sources.shodan?.isp || "Unknown";

    document.getElementById("ports").textContent =
      data.sources.shodan?.ports?.length || 0;

  } catch(e) {
    error.textContent = "Backend unreachable or API error";
  }

  loader.style.display="none";
}
</script>

</body>
</html>
